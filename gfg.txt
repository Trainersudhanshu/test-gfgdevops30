updated the code to resolve bug
new changes, updated code
